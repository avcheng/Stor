# An Overview

Stor was developed using Swift and a custom cloud storage/data service Firebase was created to serve as a backend for the app. The app was created through the storyboard method, totalling to 10 storyboards. A custom logo was also created for the app.

## Connecting to Firebase

This app was connected to Firebase, utilizing its Authentication, Database, and Storage features. To do this, a `GoogleService-Info.plist` file was inserted into the project, and CocoaPods were initialized and installed in the project folder to connect the project to Firebase. This was primarily done by following the instructions on the Firebase website to connect the 

## Log-in/Register View Controller (UserLoginViewController.swift)

The UI of the LoginViewController contains two UITextViews, one for the email of the user and one for the password of the user. These were connected using `@IBOutlet` to get the text the users were inputting to those fields. It also contains two UIButtons, one for sign up and one for log in. These were connected using `@IBAction`. When the user clicked "Sign Up", the code would take the text from the two text views and attempt to create a user in Firebase. Firebase would then confirm that the email was actually an email and that the password was greater than 6 characters long. If it was not verified, a `UIAlertController` alert was presented using `present`. If verified, a unique ID was created for the user and uploaded to the Firebase database under a 'users' dictionary. This allowed the user to then try and login. The text was taken from each textView, and then Firebase authentication was once again used to verify the credentials by pulling out each user and comparing their emails and password. If the login was incorrect, a `UIAlertController` alert was presented using `present` and the user would need to try again. If it was verified, a `segue` was activated to present the `Tab Bar View Contoller`

On each of the following viewControllers, a user Authentication method was implemented to make sure they were not logged out by using Firebase's method to check the current user's ID. If it was nil, then the user would be logged out and brought back to this View Controller.

## Tab Bar View Controller (SearchViewController.swift)

The Tab Bar View Controller was created in the storyboard section to control the storyboard to go to either the listings of spaces (starting with `ListingListViewController.swift`), upload a space (starting with `UserAddressViewController.swift`), or profile (`ProfileViewController.swift`) by activating segues to each of them. By default, the code is programmed to go the listings of spaces to allow the user to see all the spaces listed.

## Add Your Space View Controllers (UserAddressViewController.swift, UserSizeViewController.swift, UserPriceViewController.swift, UserImageViewController.swift, ConfirmationViewController.swift)

Each step in the process to add a space to the listing created in separate view controllers to give the user an easier UI/UX. 

The `UserAddressViewController.swift` was created with a `UITextView` where the user could type in their address. This value was then uploaded to the Firebase database under a `storage` section, where it would be put under a unique ID for the space and then under the value `address` for that space when the user tapped the Next button.  In addition, a value of `completed` would be set to `false` under the spaces unique ID so the app would know not to load that space in the space listings if the user canceled uploading their space. If the user clicked the cancel button, a segue was activated back the listing of spaces screen and no data would be uploaded to the Firebase database. Clicking the Next button also activated a segue to the next View Controller, which was the `UserSizeViewController.swift`.

`UserSizeViewController.swift` and `UserPriceViewController.swift` were also designed similarly with the text views and buttons, but saved to the values of `size` and `price` under the unique ID of the space under the `storage` section of the database. In addition, they contained back buttons, which activated a segue to the previous View Controller. 

Once the user progresses to the `UIImageViewController.swift` from the segue from `UserPriceViewController.swift`, they will see a `UIImageView` and accompanying `UIButton` that allows them to select an image to upload. To select activate this process, the user can tap to button which activates the presentation of a `UIImagePickerController` with the `sourceType` as the `.photoLibrary`. The user can then select a photo, which is then presented in the `UIImageView`. Once they clicke the "Add Space" to add the space, the image is then compressed using the `jpegData` function and uploaded to the Firebase Storage as a file with the name as the space's unique ID. Then, a `downloadURL` is created in the Firebase for that file and added to the Firebase Database as `image` under the space's unique ID under the `storage` section. In addition, this view controller also has the back buttons and cancel buttons like the previous view controllers that are programmed similarly. Finally, by clicking this "Add Space button, the user activates the segue to the `ConfirmationViewController.swift`. This button also sets the value of `addedBy` to the unique User Id and the value of `completed` from above to `true` in order to indicate that it can be loaded by the `ListingListViewController.swift` to viewed by everyone.

Once on the `ConfirmationViewController.swift`, there is only one `UIButton` that when clicked, activates a segue back to the `ListingListViewController.swift`. By clicking this button, the values of `rentedBy` and `status` are also set for the space to and empty string and false, so that when the space is loaded, the app will know that no one has rented the space yet.

## Listings View Controllers (ListingListViewController.swift and ListingViewController.swift)

The `ListingListViewController.swift` was created as a TableViewController called `storageTableView` that showed all the data in the Firebase storage. To get the data, a connection was created to the Firebase database and a custom class `Spaces` was created. Inside were the properties of each space, including `address`, `size`, `price`, `rentedBy` (who rented the space), and `status` (whether it was rented or not). Each storage space and its details was then pulled from Firebase and put into an array called `storageList`. However, if the storage space did not have `true` under the `completed` value, it would not be loaded into the table. This was filtered by using the Firebase functions `queryOrdered` and `queryEqual`. The `numberOfSections` was then used to designate the number of sections as 1, and then the number of cells in the table was returned to be the count of the number of elements in the `storageList`. The `address`, `size`, and `price` were loaded into each cell's text by using the `dequeueReusableCell` for each space inside the `storageList` and setting that space's cell text to a concatentation of those separate strings. 

The cells were then designated to show the storyboard for `ListingViewController.swift` when clicked by creating a segue between the cells and the viewController, which would then load each of the properties into its own `UILabel`s and `UIImageView`. To get the image, the Firebase Storage URL for each image was retrieved from the `storage` element of the space. The data was then downloaded using the `getData` function, and then converted to an `UIImage` image so the user could see it in the `UIImageView`. A `UIButton` was created at the bottom which would toggle between "Rent Now", "Cancel Rent" and also be disabled when "Your Own Space" and "Unavailable" were the options. To do this, the elements of `rentedBy` were compared against the current user's unique ID and the `status` of the rented space was checked to make sure it had been rented. If it was the current user's own space, the button would be disabled and set as "Your Own Space". If it had been rented by someone else, it would be set as "Unavailable". However, if the `rentedBy` value was empty and `status` was `false`, the user could click the button to rent it or cancel the rent. This would change the `rentedBy` and `status` values in Firebase to the user's id and `true` respectively when they clicked "Rent Now", or change them to an empty string and `false` when they clicked "Cancel Rent". Two UIDatePickers were also added but had not implementation in the code and did not affect the Firebase Database because there was not enough time to implement them.

## Profile View Controller (ProfileViewController.swift)

The Profile View Controller contains a `UILabel` that loads the email of the user from the Firebase Database by getting the unique user ID and pulling the `email` element from it. Then, it loads all the user's listed spaces similar to how `ListingListViewController.swift` loads the spaces, except it only loads the spaces where the element `addedBy` of the space equals the current user's unique ID. In addition, there is a logout button that when tapped, activates a segue back to the `UserLoginViewController` and logs out using logout function of Firebase.
